(function(){var a,h,j,g,i,d,e,f,b;if(typeof require!="undefined"&&require!==null){a=require("react")}else{a=this.React}Array.prototype.map=function(n){var o,m,k,l=[];for(o=0,m=this.length;o<m;++o){k=this[o];l.push(n(k))}return l};Array.prototype.map_=function(m){var n,l,k;for(n=0,l=this.length;n<l;++n){k=this[n];m(k)}};h={"box-shadow":"0 0 0 1px #f00"};j={};g={"box-shadow":"0 0 0 1px #f0f"};i={};d=a.createClass({componentDidMount:function(){var k;k=$(this.getDOMNode());this.props.d.willIn(k.height());return k.css(c(c({position:"absolute",opacity:0},this.props.d.stylesMoving),this.props.transite)).velocity({opacity:1},this.props.d.config.duration,this.props.d.config.easing)},componentWillUnmount:function(){var k,l;k=$(this.getDOMNode());this.props.d.willOut(k.height());l=k.clone().css(this.props.d.stylesRemoving).velocity({opacity:0},this.props.d.config.duration,this.props.d.config.easing,function(){return $(this).remove()});return $(this.props.d.portal).append(l)},componentWillReceiveProps:function(k){if(k.prev){return $(this.getDOMNode()).css(k.prev)}},componentDidUpdate:function(){var k=this;this.props.d.animStart();return $(this.getDOMNode()).velocity(this.props.transite,this.props.d.config.duration,this.props.d.config.easing,function(){return k.props.d.animEnd()})},render:function(){return a.DOM.div({},this.props.children)}});e=a.createClass({componentDidMount:function(){},render:function(){var k=this;return a.createElement("div",{className:"anicoll-floatings"},Array.prototype.slice.apply(this.props.children).sort(function(m,l){return m.key<l.key&&-1||(m.key>l.key&&1||0)}).map(function(l){return a.createElement(d,{key:l.key,ref:l.key,transite:k.props.positions[l.key],prev:k.props.prevPositions[l.key],d:k.props.d},a.cloneElement(l,{key:"c"}))}))}});f=a.createClass({getInitialState:function(){var k;k=function(l){return this(l).clone()};this.config={easing:function(m,n,l,p,o){return -p*(n/=o)*(n-2)+l},duration:350,debug:false};return{animating:false}},componentDidMount:function(){var k;$(this.getDOMNode()).css({opacity:1});k=(this.portalNode=document.createElement("div")).style;k.left=0;k.top=0;k.opacity=0;k.position="absolute";document.body.appendChild(this.portalNode);return this.renderClones({positions:this.getPositions(),children:this.props.children})},componentWillUnmount:function(){return document.body.removeChild(this.portalNode)},componentWillReceiveProps:function(k){var l=this;if(k.config){["duration","easing","debug"].map_(function(m){if(k.config[m]!=null){l.config[m]=k.config[m]}})}return this.prepareAnimation()},componentDidUpdate:function(k){return this.startAnimation()},showClones:function(k){$(this.getDOMNode()).css({opacity:!k&&1||0});return $(this.portalNode).css({opacity:k&&1||0,"z-index":k&&10||-10})},prepareAnimation:function(){return this.prev=this.getPositions()},startAnimation:function(){var m,l,k=this;this.startedAnims=0;this.renderClones({positions:this.getPositions(),prevPositions:this.prev,children:this.props.children},function(){return k.showClones(true)});if(this.heightDiff!==0){m=$(this.getDOMNode());l=m.height();if(this.heightDiff<0){return m.css({"min-height":l}).velocity({"min-height":l+this.heightDiff},this.config.duration,this.config.easing,function(){return $(this).css({"min-height":""})})}else{return m.css({"max-height":l}).velocity({"max-height":l+this.heightDiff},this.config.duration,this.config.easing,function(){return $(this).css({"max-height":""})})}}},finishAnimation:function(){return this.showClones(false)},getPositions:function(){var k,r,m,n,q,p,o,l;k={};for(r=0,n=(m=this.props.children).length;r<n;++r){q=m[r].key;p=this.refs[q].getDOMNode();o=p.getBoundingClientRect();l=getComputedStyle(p);k[q]={top:o.top-parseInt(l.marginTop,10),left:o.left-parseInt(l.marginLeft,10),width:o.width,height:o.height}}return k},animEnd:function(){if(--this.startedAnims===0){return this.finishAnimation()}},renderClones:function(m,k){var l=this;this.startedAnims=1;this.heightDiff=0;return a.render(a.createElement(e,c(c({key:"clones",d:{animStart:function(){++l.startedAnims},animEnd:function(){l.animEnd()},portal:this.portalNode,willIn:function(n){l.heightDiff+=n},willOut:function(n){l.heightDiff-=n},config:this.config,stylesMoving:this.config.debug&&h||j,stylesRemoving:this.config.debug&&g||i}},m),this.props)),this.portalNode,function(){if(typeof k=="function"){k()}l.animEnd()})},render:function(){return a.DOM.div({},this.props.children.map(function(k){return a.createElement("div",{key:k.key,ref:k.key},k)}))}});if(typeof b!="undefined"&&b!==null){if((typeof module!="undefined"&&module!==null)&&module.exports){b=module.exports=f}b.Anicoll=f}else{this.Anicoll=f}if(typeof define==="function"&&define.amd){define("Anicoll",[],function(){return f})}function c(m,n){var k={}.hasOwnProperty;for(var l in n){if(k.call(n,l)){m[l]=n[l]}}return m}}).call(this);